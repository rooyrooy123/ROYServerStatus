<!DOCTYPE html>
<html>
    <HEAD>
    <META HTTP-EQUIV="CONTENT-TYPE" CONTENT="TEXT/HTML;CHARSET=SHIFT_JIS">
    <TITLE>ブラウザとExcelの連携サンプル</TITLE>
    <SCRIPT LANGUAGE="VBS">
    '==============================================================================
    ' Excel起動
    '==============================================================================
    Sub exeExcel()
    
    Dim objExcelApp
    
    On Error Resume Next
    Err.Clear
    Set objExcelApp = CreateObject("excel.application")
    If Err Then
    ' エラー処理
    document.write "<font color=red>"
    document.write "Excelを起動できませんでした<br>"
    document.write "エラー:" & Err.Description & "<br>"
    document.write "</font><br>" & vbCrLf
    document.write "<a HREF=ie_option.htm TARGET=_BLANK>セキュリティレベル設定方法</A>"
    Else
    On Error goto 0
    objExcelApp.Workbooks.Open("c:\test.xls")
    Set objExcelBook = objExcelApp.ActiveWorkbook
    Set objExcelSheets = objExcelBook.Worksheets
    Set objExcelSheet = objExcelBook.Sheets("Sheet1")
    objExcelSheet.Activate
    objExcelApp.Application.Visible = True
    
    objExcelSheet.Cells(1,1).Value = document.MyForm.TXT_DATA1.value
    objExcelSheet.Cells(2,1).Value = document.MyForm.TXT_DATA2.value
    objExcelSheet.Cells(3,1).Value = document.MyForm.TXT_DATA3.value
    
    objExcelSheet.Activate
    
    End If
    
    End Sub
    </SCRIPT>
    </HEAD>
    <BODY>
    
    <FORM NAME="MyForm" METHOD="POST">
    
    <INPUT TYPE="TEXT" NAME="TXT_DATA1" SIZE="15" MAXLENGTH="30"><BR>
    <INPUT TYPE="TEXT" NAME="TXT_DATA2" SIZE="15" MAXLENGTH="30"><BR>
    <INPUT TYPE="TEXT" NAME="TXT_DATA3" SIZE="15" MAXLENGTH="30"><BR>
    <INPUT TYPE="BUTTON" STYLE="WIDTH:150px" VALUE="Excelへデータ送信" NAME="BTN_EXCEL" onClick="exeExcel()"><BR>
    
    </FORM>
    
    </BODY>
    </HTML>